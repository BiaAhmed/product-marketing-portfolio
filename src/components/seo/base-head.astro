---
import 'src/styles/global.css';

// all pages through the use of the <BaseHead /> component.
interface Props {
	title: string;
	description: string;
	image?: string;
}

const canonicalURL = new URL(Astro.url.pathname, Astro.site);

const { title, description, image = '/images/ogimage.png' } = Astro.props;
---

<!-- Add this before other head content -->
<script is:inline>
	const theme = (() => {
		if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
			return localStorage.getItem('theme') || 'light';
		}
		if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
			return 'dark';
		}
		return 'light';
	})();

	if (theme === 'dark') {
		document.documentElement.classList.add('dark');
	} else {
		document.documentElement.classList.remove('dark');
	}
</script>

<!-- postHog analytics (Production Only) -->
{import.meta.env.PROD && (
	<script is:inline>
		!function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init bs ws ge fs capture De calculateEventProperties $s register register_once register_for_session unregister unregister_for_session Is getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetGroupPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty xs Ss createPersonProfile Es gs opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing ys debug ks getPageViewId captureTraceFeedback captureTraceMetric".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
		posthog.init('phc_wO6Bjo5R2PNpRtGQ1igMfFutJtPUAahHTmyYUt8jjea', {
			api_host: 'https://us.i.posthog.com',
			person_profiles: 'identified_only',
		});
	</script>
)}

<!-- umami analytics{
	import.meta.env.PROD && (
		<script
			async
			defer
			data-website-id={import.meta.env.UMAMI_WEBSITE_ID}
			src={import.meta.env.UMAMI_TRACKING_URL}
		/>
	)
} -->

<!-- clarity analytics -->
<!-- {
	import.meta.env.PROD && (
		<script
			type='text/javascript'
			set:html={`
			(function(c,l,a,r,i,t,y){
				c[a] = c[a] || function() { (c[a].q=c[a].q||[]).push(arguments) };
				t=l.createElement(r); t.async=1; t.src="https://www.clarity.ms/tag/" + i;
				y=l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t,y);
			})(window, document, "clarity", "script", "${import.meta.env.CLARITY_TRACKING_ID}");
		`}
		/>
	)
} -->

<link
	rel='sitemap'
	href='/sitemap-index.xml'
/>

<!-- Global Metadata -->
<meta charset='utf-8' />
<meta
	name='viewport'
	content='width=device-width,initial-scale=1'
/>

<!-- Favicons -->
<link
	rel='apple-touch-icon'
	sizes='57x57'
	href='/apple-icon-57x57.png'
/>
<link
	rel='apple-touch-icon'
	sizes='60x60'
	href='/apple-icon-60x60.png'
/>
<link
	rel='apple-touch-icon'
	sizes='72x72'
	href='/apple-icon-72x72.png'
/>
<link
	rel='apple-touch-icon'
	sizes='76x76'
	href='/apple-icon-76x76.png'
/>
<link
	rel='apple-touch-icon'
	sizes='114x114'
	href='/apple-icon-114x114.png'
/>
<link
	rel='apple-touch-icon'
	sizes='120x120'
	href='/apple-icon-120x120.png'
/>
<link
	rel='apple-touch-icon'
	sizes='144x144'
	href='/apple-icon-144x144.png'
/>
<link
	rel='apple-touch-icon'
	sizes='152x152'
	href='/apple-icon-152x152.png'
/>
<link
	rel='apple-touch-icon'
	sizes='180x180'
	href='/apple-icon-180x180.png'
/>
<link
	rel='icon'
	type='image/png'
	sizes='192x192'
	href='/android-icon-192x192.png'
/>
<link
	rel='icon'
	type='image/png'
	sizes='32x32'
	href='/favicon-32x32.png'
/>
<link
	rel='icon'
	type='image/png'
	sizes='96x96'
	href='/favicon-96x96.png'
/>
<link
	rel='icon'
	type='image/png'
	sizes='16x16'
	href='/favicon-16x16.png'
/>
<link
	rel='manifest'
	href='/manifest.json'
/>
<meta
	name='msapplication-TileColor'
	content='#ffffff'
/>
<meta
	name='msapplication-TileImage'
	content='/ms-icon-144x144.png'
/>
<meta
	name='theme-color'
	content='#ffffff'
/>

<meta
	name='generator'
	content={Astro.generator}
/>

<!-- Canonical URL -->
<link
	rel='canonical'
	href={canonicalURL}
/>

<!-- Primary Meta Tags -->
<title>{title}</title>
<meta
	name='title'
	content={title}
/>
<meta
	name='description'
	content={description}
/>

<!-- Open Graph / Facebook -->
<meta
	property='og:type'
	content='website'
/>
<meta
	property='og:url'
	content={Astro.url}
/>
<meta
	property='og:title'
	content={title}
/>
<meta
	property='og:description'
	content={description}
/>
<meta
	property='og:image'
	content={new URL(image, Astro.url)}
/>

<!-- Twitter -->
<meta
	property='twitter:card'
	content='summary_large_image'
/>
<meta
	property='twitter:url'
	content={Astro.url}
/>
<meta
	property='twitter:title'
	content={title}
/>
<meta
	property='twitter:description'
	content={description}
/>
<meta
	property='twitter:image'
	content={new URL(image, Astro.url)}
/>

<link
	rel='alternate'
	type='application/rss+xml'
	title={`${title} RSS Feed`}
	href='/rss.xml'
/>
